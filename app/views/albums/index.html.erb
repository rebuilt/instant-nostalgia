<main class="content-wrapper">
  <p id="notice"><%= notice %></p>

  <h1>Albums</h1>

  <div class="row">
    <%= form_with(model: @album, local: true, class: "mr-3") do |form| %>
      <% if @album.errors.any? %>
        <div id="error_explanation">
          <h2><%= pluralize(@album.errors.count, "error") %> prohibited this album from being saved:</h2>

          <ul>
            <% @album.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <div class="row">
        <h3 class="input-group">
          <%= form.label :title, class: "input-group__label m-0 mr-3" %>
        </h3>
        <div class="input-group ">
          <%= form.text_field :title , class: "input-group__field m-0 mr-6"%>
        </div>

        <div class="input-group">
          <%= form.submit class: "btn btn--primary"%>
        </div>
      </div>
    <% end %>

    <ul >
      <% @albums.each do |album| %>
        <div id="album-<%= album.id  %>" class="row end mt-2">
          <li><h3><%= link_to album.title, album, class: "btn" %></h3></a></li>
          <li><%= link_to 'View', album , class: "btn btn--primary no-radius"%></li>
          <li>
            <%= form_with(url: new_share_path, method: :get, local: true) do |form|  %>
              <%= hidden_field_tag("album_id", album.id)  %>
              <%= form.submit("Share album ", class: 'btn btn--primary no-radius')  %>
            <% end %>
          </li>
          <li><%= link_to 'Remove album', album, method: :delete, class: "btn btn--warning no-radius", data: { confirm: 'Are you sure?' } %></li>
        </div>
      <% end %>
    </ul>
  </div>

  <div class="photos mt-5 pt-5">
    <h2 class="mb-5">Your Photos</h2>

    <%= form_with(url: photo_album_path(1), method: :patch, local: true) do |form| %>
      <div class="actions row">
        <p class="mr-4"> Select an album  </p>
        <div class="mr-5">
          <%= select_tag("album", options_from_collection_for_select(current_user.albums, "id", "title" ))  %>
        </div>
        <%= form.submit("Add to album", class: "btn btn--primary ml-5") %>
      </div>

      <div class="gallery mt-5">
        <% @photos.each do |photo|   %>

          <div class="photo-selector ">
            <%= link_to(photo_path(photo) ) do  %>
              <%= image_tag(photo.image.variant(resize: '300x300')) if photo.image.attached? %>
            <% end %>

            <div class="mt-3">
              <%= hidden_field_tag "hidden_checked[#{photo.id}]", false %>
              <%= check_box_tag("checked[#{photo.id}]", value: photo.id)  %>
            </div>

          </div>

        <% end %>
      </div>

    <% end %>
  </div>
</main>
