<div class="content-wrapper">
  <%= link_to "To Shares", shares_path, class: "btn btn--primary btn__inline"  %>
  <h1 class="mt-3">Share your album</h1>
  <h2>
    Album title: <%= @album.title  %>
  </h2>

  <% if @share.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@share.errors.count, "error") %> prohibited this album from being saved:</h2>

      <ul>
        <% @share.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div>
    <div class="find-user">
      <%= form_with(url: new_share_path , method: :get, local: :true) do |form| %>
        <div class="row mt-3">
          <h4 class="input-group mr-3">
            <%= label_tag :search, "Who would you like to share #{@album.title} with?", class: "input-group__label"%>
          </h4>
          <div class="input-group mr-3">
            <%= form.text_field :search, class: "input-group__field m-0 " %>
          </div>
          <%= hidden_field_tag "album_id", @album.id %>
          <div class="actions">
            <%= form.submit("Search for User", class: "btn btn--primary") %>
          </div>
        </div>
      <% end %>
    </div>

    <div id="results" class="results mt-5" >
      <div class="row">
        <h3 class="mr-3"> You searched for: </h3> <span> <%= @term  %> </span>
      </div>
      <% if(@users.present?)%>
        <% @users.each do |user|  %>
          <%= form_with(url: shares_path) do |form| %>
            <div class="row mt-3">
              <p class="mr-5"> <%= user.username %> </p>
              <p class="mr-5"> <%= user.email  %> </p>
              <%= hidden_field_tag "user_id", user.id %>
              <%= hidden_field_tag "album_id", @album.id %>
              <%= form.submit("Share #{@album.title} with #{user.username}", class: "btn btn--primary") %>
            </div>
          <% end %>
        <% end %>
      <% end %>
    </div>
  </div>
</div>
